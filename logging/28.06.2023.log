2023-06-28 14:10:26,756 - [INFO] - sql.py - exec_it_database(859) - START SQL session
2023-06-28 14:38:01,064 - [INFO] - sql.py - exec_it_database(864) - request select id as sub_id inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection id in (select id from knd_inspection where year=2023 and profilactic=0 and status='Исключена')))
2023-06-28 14:38:01,089 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'inn from knd_subject where id in (select subject_id from knd_object where id in ' at line 1")
2023-06-28 14:44:02,665 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, number, (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:44:03,060 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1146, "Table 'knm.knd_m_to_m_inspection' doesn't exist")
2023-06-28 14:44:29,527 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, number, (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:45:06,761 - [INFO] - sql.py - exec_it_database(864) - request wte
2023-06-28 14:45:09,936 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, number, (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:47:10,494 - [INFO] - sql.py - exec_it_database(864) - request 
2023-06-28 14:47:10,505 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1065, 'Query was empty')
2023-06-28 14:47:10,505 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, (select name from terr_upravlenie where id=terr_upr_id), status, number, (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:47:10,515 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1146, "Table 'knm.terr_upravlenie' doesn't exist")
2023-06-28 14:47:52,785 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, (select name from knd_terr_upravlenie where id=terr_upr_id), status, number, (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:48:31,004 - [INFO] - sql.py - exec_it_database(864) - request wte
2023-06-28 14:48:31,868 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, (select name from knd_terr_upravlenie where id=terr_upr_id), status, number, (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:49:15,602 - [INFO] - sql.py - exec_it_database(864) - request wte
2023-06-28 14:49:50,194 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, (select name from knd_terr_upravlenie where id=terr_upr_id), date_start, date_end, status, number, (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:51:07,288 - [INFO] - sql.py - exec_it_database(864) - request wte
2023-06-28 14:51:28,708 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, (select name from knd_terr_upravlenie where id=terr_upr_id), status, number, (select inn, name from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:51:28,714 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1241, 'Operand should contain 1 column(s)')
2023-06-28 14:52:20,819 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, (select name from knd_terr_upravlenie where id=terr_upr_id), status, number, (select name from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))), (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 14:52:25,711 - [INFO] - sql.py - exec_it_database(894) - SQL error: [Errno 13] Permission denied: 'C:\\Users\\zaitsev_ad\\Desktop\\сведения из базы данных.xlsx'
2023-06-28 14:52:37,088 - [INFO] - sql.py - exec_it_database(864) - request select id as insp_id, (select name from knd_terr_upravlenie where id=terr_upr_id), status, number, (select name from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))), (select inn from knd_subject where id in (select subject_id from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (insp_id)))) from knd_inspection where year=2023 and status='Не может быть проведено'
2023-06-28 18:28:39,826 - [INFO] - sql.py - exec_it_database(859) - START SQL session
2023-06-28 18:29:24,229 - [INFO] - sql.py - exec_it_database(864) - request select number from knd_inspection where profilactic=1
2023-06-28 18:31:13,764 - [INFO] - sql.py - exec_it_database(864) - request select number from knd_inspection where profilactic=1 and kind='Профилактический визит'
2023-06-28 18:35:30,832 - [INFO] - sql.py - exec_it_database(864) - request select knm_id from knd_inspection where profilactic=1 and kind='Профилактический визит'
2023-06-28 18:45:34,910 - [INFO] - sql.py - exec_it_database(864) - request select knm_id from knd_inspection where profilactic=1 and kind='Профилактический визит' and status='Завершено'
2023-06-28 18:56:14,779 - [INFO] - sql.py - exec_it_database(864) - request select count(*) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023)) and risk='чрезвычайно высокий риск'
2023-06-28 18:57:32,678 - [INFO] - sql.py - exec_it_database(864) - request select count(*) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023)) and risk='чрезвычайно высокий риск'
2023-06-28 18:59:44,615 - [INFO] - sql.py - exec_it_database(864) - request select count(*) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0)) and risk='чрезвычайно высокий риск'
2023-06-28 19:00:59,849 - [INFO] - sql.py - exec_it_database(864) - request select count(*) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0)) and risk='высокий риск'
2023-06-28 19:02:39,916 - [INFO] - sql.py - exec_it_database(864) - request select count(*) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:03:36,191 - [INFO] - sql.py - exec_it_database(864) - request select number from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:03:36,200 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1054, "Unknown column 'number' in 'field list'")
2023-06-28 19:05:43,357 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection where object_id=obj_id)) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:05:43,365 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(select number from knd_inspection where id in (select inspection_id from knd_m_' at line 1")
2023-06-28 19:06:40,486 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id, (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection where object_id=obj_id)) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:06:42,680 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1242, 'Subquery returns more than 1 row')
2023-06-28 19:08:45,381 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection where object_id=obj_id)[1]) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:08:45,386 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(select number from knd_inspection where id in (select inspection_id from knd_m_' at line 1")
2023-06-28 19:12:22,405 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection limit 1 where object_id=obj_id)) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:12:22,411 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(select number from knd_inspection where id in (select inspection_id from knd_m_' at line 1")
2023-06-28 19:12:49,063 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id, (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection limit 1 where object_id=obj_id)) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:12:49,073 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where object_id=obj_id)) from knd_object where id in (select object_id from knd_' at line 1")
2023-06-28 19:14:12,225 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id, (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection where object_id=obj_id select id as obj_id, (select num)) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:14:12,231 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select id as obj_id, (select num)) from knd_object where id in (select object_id' at line 1")
2023-06-28 19:14:29,150 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id, (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection where object_id=obj_id limit 1)) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:14:29,171 - [INFO] - sql.py - exec_it_database(894) - SQL error: (1235, "This version of MySQL doesn't yet support 'LIMIT & IN/ALL/ANY/SOME subquery'")
2023-06-28 19:16:38,397 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id, (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection where object_id=obj_id)  limit 1) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id=0)) and risk='умеренный риск'
2023-06-28 19:19:01,579 - [INFO] - sql.py - exec_it_database(864) - request select id as obj_id, (select number from knd_inspection where id in (select inspection_id from knd_m_to_m_object_inspection where object_id=obj_id)  limit 1) from knd_object where id in (select object_id from knd_m_to_m_object_inspection where inspection_id in (select id from knd_inspection where year=2023 and profilactic=0 and plan_id!=0)) and risk='умеренный риск'
